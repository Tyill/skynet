sudo: true
#dist: xenial
osx_image: xcode8

language: cpp

os:
  #- linux
  - osx

compiler:
  - gcc
  - clang

cache:
  directories:
    - $HOME/.ccache
    - $HOME/.cache/pip
    - $HOME/Library/Caches/Homebrew
  
addons:
  apt:
    sources:
    
    packages: 
    - cmake

branches:
  #only:
    #- master
    
env:
  global:
    
  matrix:
    - USE_AVX=OFF
    - USE_AVX=ON
    
    
matrix:
  exclude: # On OSX g++ is a symlink to clang++ by default
    - os: osx
      compiler: gcc

before_install:  

install: 
  - HOMEBREW_NO_AUTO_UPDATE=1 brew install ccache
  - bash -x .travis/install.sh
  
before_script:
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then
      cd src;
      cmake -DUSE_AVX=$USE_AVX
            -DGPU=NONE .;
      ls ;
    fi
  - if [ "$TRAVIS_OS_NAME" == "osx" ]; then
      cd src;
      cmake --trace -DUSE_AVX=$USE_AVX
                    -DGPU=NONE .;     
    fi
 
script:
  - make -j2

after_success:
  
